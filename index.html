<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Soy IBA</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #fafafa;
    }

    /* Gradiente tipo Instagram */
    .insta-gradient {
      background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
    }

    /* Modal visible */
    .story-active {
      display: flex !important;
    }

    /* AnimaciÃ³n fade */
    .fade {
      animation: fadein 0.5s;
    }

    @keyframes fadein {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* Barra de progreso */
    .progress-bar {
      transition: width 1s linear;
    }
  </style>
</head>
<body class="text-gray-800">

  <!-- RIBBON SUPERIOR -->
  <header class="flex items-center justify-between p-4 bg-white shadow">
    <h1 class="text-2xl font-bold text-pink-600">Soy IBA</h1>
    <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8h16M4 16h16" />
    </svg>
  </header>

  <!-- EVENTOS -->
  <section class="p-3 overflow-x-auto flex gap-4">
    <div class="flex gap-4">
      <div class="flex-shrink-0 text-center cursor-pointer" onclick="openStory(0)">
        <div class="p-[2px] rounded-full insta-gradient">
          <img src="https://images.unsplash.com/photo-1497032628192-86f99bcd76bc?w=200" class="w-20 h-20 rounded-full object-cover border-2 border-white">
        </div>
        <p class="text-xs mt-1">Concierto </p>
      </div>

      <div class="flex-shrink-0 text-center cursor-pointer" onclick="openStory(1)">
        <div class="p-[2px] rounded-full insta-gradient">
          <img src="https://images.unsplash.com/photo-1551836022-4c4c79ecde51?w=200" class="w-20 h-20 rounded-full object-cover border-2 border-white">
        </div>
        <p class="text-xs mt-1">ReuniÃ³n</p>
      </div>

      <div class="flex-shrink-0 text-center cursor-pointer" onclick="openStory(2)">
        <div class="p-[2px] rounded-full insta-gradient">
          <img src="https://images.unsplash.com/photo-1535930749574-1399327ce78f?w=200" class="w-20 h-20 rounded-full object-cover border-2 border-white">
        </div>
        <p class="text-xs mt-1">Domingo</p>
      </div>
    </div>
  </section>
  <!--Novedades de sheet-->
<section id="novedades" class="p-4 space-y-6"></section>

  <!-- NOVEDADES -->
  <section class="p-4 space-y-6">
    <div class="bg-white rounded-2xl shadow">
      <img src="https://images.unsplash.com/photo-1497493292307-31c376b6e479?w=800" class="w-full h-64 object-cover rounded-t-2xl">
      <div class="p-3">
        <h2 class="font-semibold text-lg">TransmisiÃ³n en vivo ðŸŽ¥</h2>
        <p class="text-gray-600 text-sm mt-1">Disfruta del mensaje del domingo a las 10 AM.</p>
        <div class="flex justify-between items-center mt-3">
          <span class="text-xs text-gray-400">Publicado: 9 oct 2025</span>
          <button class="text-pink-600 text-sm" onclick="sharePost('TransmisiÃ³n en vivo')">Compartir</button>
        </div>
      </div>
    </div>

    <div class="bg-white rounded-2xl shadow">
      <img src="https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=800" class="w-full h-64 object-cover rounded-t-2xl">
      <div class="p-3">
        <h2 class="font-semibold text-lg">Noche de Alabanza âœ¨</h2>
        <p class="text-gray-600 text-sm mt-1">Ãšnete a nosotros para una noche de adoraciÃ³n y mÃºsica.</p>
        <div class="flex justify-between items-center mt-3">
          <span class="text-xs text-gray-400">Publicado: 7 oct 2025</span>
          <button class="text-pink-600 text-sm" onclick="sharePost('Noche de Alabanza')">Compartir</button>
        </div>
      </div>
    </div>
  </section>

  <!-- STORY MODAL -->
  <div id="storyModal" class="hidden fixed inset-0 bg-black bg-opacity-90 justify-center items-center z-50">
    <!-- X SIEMPRE VISIBLE -->
    <button onclick="closeStory()" class="absolute top-4 right-4 text-white text-3xl font-bold z-50">Ã—</button>

    <!-- Barra de progreso y contador -->
    <div class="absolute top-0 left-0 w-full px-6 pt-5 z-40">
      <div class="h-1 bg-gray-500 rounded-full overflow-hidden">
        <div id="progressBar" class="h-1 bg-pink-500 progress-bar" style="width:0%"></div>
      </div>
      <p id="countdown" class="text-white text-sm mt-1 text-right">5s</p>
    </div>

    <div class="relative w-full h-full flex items-center justify-center">
      <div id="storyContent" class="relative w-full h-full flex items-center justify-center fade">
        <img id="storyImage" src="" class="object-cover w-full h-full">
        <div class="absolute bottom-0 w-full bg-gradient-to-t from-black/80 to-transparent p-6 text-white">
          <h2 id="storyTitle" class="text-xl font-bold"></h2>
          <p id="storyDesc" class="text-sm"></p>
          <button id="shareBtn" onclick="shareStory()" class="absolute bottom-6 right-6 text-white bg-pink-500 rounded-full p-2 text-xs">ðŸ”—</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const stories = [
      {
        img: "https://images.unsplash.com/photo-1497032628192-86f99bcd76bc?w=1080",
        title: "Concierto de Fe",
        desc: "Una noche llena de mÃºsica y esperanza."
      },
      {
        img: "https://images.unsplash.com/photo-1551836022-4c4c79ecde51?w=1080",
        title: "ReuniÃ³n de lÃ­deres",
        desc: "Creciendo juntos en propÃ³sito."
      },
      {
        img: "https://images.unsplash.com/photo-1535930749574-1399327ce78f?w=1080",
        title: "Domingo de adoraciÃ³n",
        desc: "Ven y comparte con nosotros."
      }
    ];

    let currentStory = 0;
    let autoAdvance;
    let countdownInterval;
    const duration = 5; // segundos
    let remaining = duration;

    function showStory(index) {
      currentStory = index;
      const story = stories[index];
      document.getElementById("storyImage").src = story.img;
      document.getElementById("storyTitle").innerText = story.title;
      document.getElementById("storyDesc").innerText = story.desc;
      resetProgress();
    }

    function openStory(index) {
      const modal = document.getElementById("storyModal");
      modal.classList.remove("hidden");
      modal.classList.add("flex");
      showStory(index);
      startAutoAdvance();
    }

    function closeStory() {
      const modal = document.getElementById("storyModal");
      modal.classList.add("hidden");
      modal.classList.remove("flex");
      clearInterval(autoAdvance);
      clearInterval(countdownInterval);
      resetProgress(true);
    }

    function nextStory() {
      currentStory = (currentStory + 1) % stories.length;
      showStory(currentStory);
    }

    function startAutoAdvance() {
      clearInterval(autoAdvance);
      clearInterval(countdownInterval);
      remaining = duration;
      updateCountdown();

      countdownInterval = setInterval(() => {
        remaining--;
        updateCountdown();
        if (remaining <= 0) {
          nextStory();
        }
      }, 1000);

      let progress = 0;
      const progressBar = document.getElementById("progressBar");
      progressBar.style.width = "0%";

      autoAdvance = setInterval(() => {
        progress += 20; // cada segundo equivale al 20%
        progressBar.style.width = progress + "%";
        if (progress >= 100) {
          progress = 0;
          progressBar.style.width = "0%";
        }
      }, 1000);
    }

    function resetProgress(clear = false) {
      const progressBar = document.getElementById("progressBar");
      progressBar.style.width = clear ? "0%" : "100%";
      remaining = duration;
      updateCountdown();
    }

    function updateCountdown() {
      document.getElementById("countdown").innerText = remaining + "s";
    }

    function shareStory() {
      const story = stories[currentStory];
      if (navigator.share) {
        navigator.share({
          title: story.title,
          text: story.desc,
          url: window.location.href
        });
      } else {
        alert("Tu navegador no soporta compartir.");
      }
    }

    function sharePost(title) {
      if (navigator.share) {
        navigator.share({
          title: title,
          url: window.location.href
        });
      } else {
        alert("Tu navegador no soporta compartir.");
      }
    }

    

    
  </script>

<script>
async function cargarNovedades() {
  const url = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSyHmU-0ZwmCIFmwaaiC8FLVhSU4n6GNBh4JGtlgf89LWG-4wVW_7Awh8ICilQi5xd5qDVEnfyC2i2O/pub?output=csv";

  try {
    const response = await fetch(url);
    const data = await response.text();

    // Dividir las filas y omitir encabezado
    const rows = data.split("\n").slice(1);

    // Convertir cada fila en un objeto
    const novedades = rows.map(row => {
      const columnas = row.split(",");
      const [MarcaTemporal, Titulo, Contenido, Imagen, Video, Spotify, Fecha] = columnas;
      return { MarcaTemporal, Titulo, Contenido, Imagen, Video, Spotify, Fecha };
    }).filter(n => n.Titulo && n.Titulo.trim() !== ""); // evitar filas vacÃ­as

    // Ordenar por fecha (de mÃ¡s nueva a mÃ¡s vieja)
    novedades.sort((a, b) => new Date(b.Fecha) - new Date(a.Fecha));

    const contenedor = document.getElementById("novedades");
    contenedor.innerHTML = "";

    novedades.forEach(n => {
      const card = document.createElement("div");
      card.className = "bg-white rounded-2xl shadow border border-gray-200";

      // Mostrar solo un tipo de medio por prioridad: Imagen > Video > Spotify
      let multimedia = "";
      if (n.Imagen && n.Imagen.trim() !== "") {
        multimedia = `<img src="${n.Imagen.trim()}" class="w-full h-64 object-cover rounded-t-2xl">`;
      } else if (n.Video && n.Video.trim() !== "") {
        // Ajustar si es un link de YouTube normal
        let videoUrl = n.Video.trim();
        if (videoUrl.includes("watch?v=")) {
          videoUrl = videoUrl.replace("watch?v=", "embed/");
        }
        multimedia = `<iframe class="w-full h-64 rounded-t-2xl" src="${videoUrl}" frameborder="0" allowfullscreen></iframe>`;
      } else if (n.Spotify && n.Spotify.trim() !== "") {
        multimedia = `<iframe class="w-full h-20" src="${n.Spotify.trim()}" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>`;
      }

      card.innerHTML = `
        ${multimedia}
        <div class="p-3">
          <h2 class="font-semibold text-lg">${n.Titulo}</h2>
          <p class="text-gray-600 text-sm mt-1">${n.Contenido}</p>
          <div class="flex justify-between items-center mt-3">
            <span class="text-xs text-gray-400">Publicado: ${n.Fecha}</span>
            <button class="text-pink-600 text-sm" onclick="sharePost('${n.Titulo}')">Compartir</button>
          </div>
        </div>
      `;
      contenedor.appendChild(card);
    });
  } catch (error) {
    console.error("Error al cargar la hoja:", error);
  }
}

function sharePost(titulo) {
  if (navigator.share) {
    navigator.share({
      title: titulo,
      text: "Mira esta novedad:",
      url: window.location.href
    });
  } else {
    alert("Tu navegador no soporta compartir");
  }
}

window.addEventListener("DOMContentLoaded", cargarNovedades);
</script>
</body>
</html>




